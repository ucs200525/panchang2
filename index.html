<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>Pachangam Table</title>
    <style>
        body {
            font-family: Calibri;
            margin: 0;
            padding: 0;
            background-color: #dfd9d9;
        }

        .navbar {
            background-color: #333;
            overflow: hidden;
            color: white;
            padding: 1rem;
        }

        .navbar a {
            color: white;
            text-decoration: none;
            padding: 14px 20px;
            display: inline-block;
        }

        .navbar a:hover {
            background-color: #ddd;
            color: black;
        }

        table {
            width: 80%;
            border-collapse: collapse;
            border: 2px solid black;
            margin: 20px auto;
        }

        th, td {
            border: 1px solid #000;
            padding: 0px;
            text-align: center;
            white-space: nowrap;
            font-size: 15px;
            font-weight: normal;
        }

        th {
            font-weight: bold;

        }

        .header-in-table {
            background-color: #70AD47;
        }

        td, th {
            height: 20px;
            width: 45px;
        }


        .sunrise-today {
            background-color: #ED7D31;
        }

        .sunset-today {
            background-color: #FF0000;
        }

        .blue-background {
            background-color: #002060;
        }

        .sunrise-tmrw {
            background-color: #FFD966;
        }
        .weekday-column {
            width: 100px; /* Adjust width as needed */
            text-align: center;
            overflow: hidden; /* Ensure text doesn't overflow */
            white-space: nowrap; /* Prevent text from wrapping */
        }
        .information {
            display: flex; /* Use flexbox for horizontal alignment */
            align-items: center; /* Vertically align items in the center */
            margin: 5px;
            /* Optional: add margin around the container */
        }

        .color-box {
            width: 15px; /* Adjust size as needed */
            height: 15px; /* Adjust size as needed */
            background-color: rgb(0, 32, 96);
            border-radius: 50%; /* Makes the box round */
            border: 1px solid #000; /* Optional: border to make the box more visible */
            margin-right: 10px; /* Space between the color box and text */
        }

        .info {
            font-family: sans-serif, Arial, Helvetica;
            font-size: 16px;
        }

        p {
            margin: 0; /* Remove default margin */
            font-size: 25px; /* Adjust size as needed */
           /* Space between the asterisk and the color box */
        }
        /* General button styling */
        .share-button {
            background-color: #007bff; /* Blue background */
            color: white; /* White text */
            border: none; /* Remove border */
            border-radius: 50%; /* Circular button */
            width: 60px; /* Width of button */
            height: 60px; /* Height of button */
            padding: 0; /* Remove padding */
            font-size: 24px; /* Font size */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s; /* Smooth transitions */
            margin: 10px; /* Margin for spacing */
            display: flex; /* Flexbox to center icon */
            align-items: center; /* Center icon vertically */
            justify-content: center; /* Center icon horizontally */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Shadow below button */
        }

        /* Button hover effects */
        .share-button:hover {
            background-color: #0056b3; /* Darker blue on hover */
            transform: scale(1.05); /* Slightly enlarge button */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3); /* Enhance shadow on hover */
        }

        /* Button active state */
        .share-button:active {
            background-color: #004494; /* Even darker blue when clicked */
            transform: scale(0.95); /* Slightly shrink button */
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2); /* Adjust shadow when clicked */
        }

        /* Button focus state for accessibility */
        .share-button:focus {
            outline: none; /* Remove default focus outline */
            box-shadow: 0 0 0 3px rgba(38, 143, 255, 0.5); /* Add custom focus outline */
        }

        /* Icon styling */
        .share-button i {
            font-size: 24px; /* Adjust icon size */
        }

        .download-button{
            margin: 0px;
        }

        @media (max-width: 640px) {
        *{
            margin: 0;
            font-family: sans-serif,Arial,  Helvetica;
            font-size: 16px;
            /* Allows scrolling if content overflows */
            
        }

            /* Hide the last two <th> elements in the <tr> */
            thead th:nth-last-child(1),
            thead th:nth-last-child(2),
            thead th:nth-last-child(3) {
             display:none ; /* or visibility: hidden; */
        }
      
        /*hide the corresponding <td> elements in the <tbody> if needed */
            tbody td:nth-last-child(1),
            tbody td:nth-last-child(2),
            thead th:nth-last-child(3)  {
            display:none /* or visibility: hidden; */
        }
        
        th, td {
            border: 1px solid #000;
            padding: 5px;
            font-size: 16px;
            font-weight: normal;
        }
        
        table {
            width: 90%;
        }



        .input-city, .input-date {
            display: block; /* Make each input and label block-level for separate lines */
            margin: 5px auto; /* Center the elements and add vertical spacing */
        }

        .input-city {
            width: 80%; /* Adjust width as needed */
        }

        .input-date {
            
            width: 80%; /* Adjust width as needed */
        }

        button {
            display: block;
            margin: 20px auto; /* Center the button and add vertical spacing */
        }

        .input-time{
            display: none;
        }

        .navbar {
            position: fixed; /* Keep navbar fixed at the top */
            top: 0;
            left: 0;
            width: 100%; /* Full width of the viewport */
            background-color: #333; /* Change this to your desired color */
            color: white; /* Text color */
            padding: 10px; /* Add padding if needed */
            z-index: 1000; /* Ensure it stays on top of other content */
        }

        .content {
            padding-top: 65px; /* Adjust based on the height of your navbar */
        }


        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <div class="navbar">
        <a href="#">Home</a>
        <a href="#">About</a>
        <a href="#">Contact</a>
    </div>

    <div class="content">
    <!-- City Name and Date Input and Form -->
    <div  style="text-align: center; margin: 20px;">
        <label class=input-city for="cityName">Enter City Name:</label>
        <input class=input-city type="text" id="cityName" name="cityName" >
        <label class=input-date for="dateInput">Enter Date:</label>
        <input class=input-date type="date" id="dateInput" name="dateInput" >
        <button onclick="handleButtonClick()">Get Panchangam</button>
        <button onclick="handleButtonClick()" id="toggleFormat">12-hour</button>
    </div>

    <!-- Pachangam Request Form -->
    <div class= input-time style="text-align: center; margin: 20px;">
        <label for="sunriseToday">Sunrise Today:</label>
        <input id="sunriseToday" name="sunriseToday" value="05:00:00">
        <label for="sunsetToday">Sunset Today:</label>
        <input id="sunsetToday" name="sunsetToday" value="18:00:00">
        <label for="sunriseTmrw">Sunrise Tomorrow:</label>
        <input id="sunriseTmrw" name="sunriseTmrw" value="06:00:00">
        <label for="weekday">Weekday:</label>
        <input type="text" id="weekday" name="weekday" value="Monday">
        <button onclick="handleButtonClick()">Update Table</button>
    </div>

    <div class="information">
        <p>*</p>
        <div class="color-box" style="background-color: rgb(0, 32, 96);"></div>
        <div class="info"> is considered as <strong>ashubh</strong> (inauspicious).</div>
    </div>
    <!-- Loading Message -->
    <div id="loadingMessage" style="display: none; text-align: center; margin: 20px; font-size: 20px; color: #ff0000;">
        Loading, please wait...
    </div>

</div>

    <!-- Table -->
    <table id="tableToCapture">
        <thead>
            <tr>
                <th class="header-in-table">STRAT</th>
                <th class="header-in-table">END</th>
                <th class="header-in-table" id="weekday-html">Monday</th>
                <th class="header-in-table">STRAT</th>
                <th class="header-in-table">END</th>
                <th class="header-in-table">S.no</th>
                <th></th>
                <th></th>
            </tr>
        </thead>
        <tbody id="table-body">
            <!-- Table rows will be generated by JavaScript -->
        </tbody>
    </table>
    <div class="download-button">
        <button class="share-button" onclick="takeScreenshot()">
            <i class="far fa-share-square"></i>
        </button>
    </div>

    <script>
// Function to fetch coordinates and time zone based on the city name
async function fetchCoordinates(city) {
    const apiKey = '699522e909454a09b82d1c728fc79925'; // Your API key
    try {
        const response = await fetch(`https://api.opencagedata.com/geocode/v1/json?q=${encodeURIComponent(city)}&key=${apiKey}`);
        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }
        const data = await response.json();
        if (data.results.length > 0) {
            const {limit , remaining , reset } = data.rate;
            console.log("limit , remaining , reset :",limit , remaining , reset);
            const { lat, lng } = data.results[0].geometry;
            const timeZone = data.results[0].annotations.timezone.name;
            return { lat, lng, timeZone }; // Return all required values
        } else {
            throw new Error('City not found');
        }
    } catch (error) {
        console.error('Error fetching coordinates:', error);
        alert('Please check the city name or try again later.');
        return null; 
    }
}

async function fetchCityName(lat, lng) {
    const apiKey = '699522e909454a09b82d1c728fc79925'; // Your API key
    try {
        const response = await fetch(`https://api.opencagedata.com/geocode/v1/json?q=${encodeURIComponent(lat)},${encodeURIComponent(lng)}&key=${apiKey}`);
        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }
        const data = await response.json();
        if (data.results.length > 0) {
            const { limit, remaining, reset } = data.rate;
            console.log("limit, remaining, reset:", limit, remaining, reset);
            const components = data.results[0].components;
            const city = components.city || components.town || components.village || 'Unknown city';
            
            const timeZone = data.results[0].annotations.timezone.name;
            return { cityName: city, timeZone }; // Return city name and time zone
        } else {
            throw new Error('Location not found');
        }
    } catch (error) {
        console.error('Error fetching city name:', error);
        alert('Please check the coordinates or try again later.');
        return null;
    }
}

async function autoGeolocation() {
    return new Promise((resolve, reject) => {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                async position => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const cityTime = await fetchCityName(lat, lng);
                    resolve(cityTime);
                },
                error => {
                    console.error('Geolocation error:', error);
                    alert('Could not retrieve location. Please try again.');
                    reject(error);
                }
            );
        } else {
            alert('Geolocation is not supported by this browser.');
            reject(new Error('Geolocation not supported'));
        }
    });
}

async function handleButtonClick() {
    const cityInputElement = document.getElementById("cityName");
    const cityInfo = cityInputElement.value.trim(); // Trim any whitespace
    console.log("cityname", cityInfo);
    
    if (cityInfo === "") { // Check if the input is an empty string
        try {
            const cityTime = await autoGeolocation();
            if (cityTime) {
                const cityname = cityTime.cityName;
                cityInputElement.value = cityname;
                fetchAndUpdateTimes();
            }
        } catch (error) {
            console.error('Error in autoGeolocation:', error);
        }
    } else {
        // Use the provided cityInfo for fetching and updating times
        fetchAndUpdateTimes();
    }
}


// Function to convert UTC time to local time based on time zone
const convertToLocalTime = (utcDate, timeZone) => {
    const date = new Date(utcDate);
    return date.toLocaleString('en-US', { timeZone, hour12: false }).split(' ')[1];
};

// Function to fetch sunrise and sunset times for a given date
async function fetchSunTimes(lat, lng, date, timeZone) {
    try {
        const response = await fetch(`https://api.sunrise-sunset.org/json?lat=${lat}&lng=${lng}&formatted=0&date=${date}`);
        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }
        const data = await response.json();
        const results = data.results;

        // Convert UTC time to local time based on timeZone
        return {
            sunrise: convertToLocalTime(results.sunrise, timeZone),
            sunset: convertToLocalTime(results.sunset, timeZone),
            solar_noon: convertToLocalTime(results.solar_noon, timeZone),
            civil_twilight_begin: convertToLocalTime(results.civil_twilight_begin, timeZone),
            civil_twilight_end: convertToLocalTime(results.civil_twilight_end, timeZone),
            nautical_twilight_begin: convertToLocalTime(results.nautical_twilight_begin, timeZone),
            nautical_twilight_end: convertToLocalTime(results.nautical_twilight_end, timeZone),
            astronomical_twilight_begin: convertToLocalTime(results.astronomical_twilight_begin, timeZone),
            astronomical_twilight_end: convertToLocalTime(results.astronomical_twilight_end, timeZone),
        };
    } catch (error) {
        console.error('Error fetching sun times:', error);
        alert('There was an error fetching sun times. Please try again later.');
        return null;
    }
}


async function getSunTimesForCity(city, date) {
    let coords = await fetchCoordinates(city);
    if (coords) {
        const sunTimes = await fetchSunTimes(coords.lat, coords.lng, date, coords.timeZone);
        console.log(sunTimes);
        return sunTimes;
    }
    return null;
}


// Function to get the weekday name from a date
function getWeekday(dateString) {
    const date = new Date(dateString);
    const options = { weekday: 'long' };
    return date.toLocaleDateString('en-US', options);
}


async function fetchAndUpdateTimes() {
    const city = document.getElementById('cityName').value;
    const userEnteredDate = document.getElementById('dateInput').value; // Get the date entered by the user

    if (!city) {
        alert('Please enter a city name.');
        return;
    }



document.getElementById('loadingMessage').style.display = 'block'; // Show loading message
// Function to get the current date in a specific timezone
function getCurrentDateInTimeZone(timeZone) {
    const options = {
        timeZone: timeZone,
        year: 'numeric',
        month: '2-digit',
        day: '2-digit'
    };
    const formatter = new Intl.DateTimeFormat('en-GB', options); // 'en-GB' ensures consistent ordering
    const [{ value: day },, { value: month },, { value: year }] = formatter.formatToParts(new Date());
    return `${year}-${month}-${day}`;
}


    let coords = await fetchCoordinates(city); // Fetch coordinates and time zone

    // Get current date in India
    const currentDate = getCurrentDateInTimeZone(coords.timeZone);
    console.log("currentDate:",currentDate)
    console.log("timezone:",coords.timeZone)
    // Use user-entered date if provided, otherwise use current date
    const date =  userEnteredDate || currentDate ;
    document.getElementById('dateInput').value = date;
    console.log("Date taken:",date )
    try {
        
        if (coords) {
            const { lat, lng, timeZone } = coords; // Destructure timeZone here

            // Fetch sun times for today
            const todayTimes = await fetchSunTimes(lat, lng, date, timeZone);
            if (!todayTimes) return;

            const todayWeekday = getWeekday(date);
            const tomorrow = new Date(date);
            tomorrow.setDate(tomorrow.getDate() + 1);
            const tomorrowDate = tomorrow.toISOString().split('T')[0];

            // Fetch sun times for tomorrow
            const tomorrowTimes = await fetchSunTimes(lat, lng, tomorrowDate, timeZone);
            if (!tomorrowTimes) return;

            const sunriseToday = todayTimes.sunrise;
            const sunsetToday = todayTimes.sunset;
            const sunriseTmrw = tomorrowTimes.sunrise;
            const tomorrowWeekday = getWeekday(tomorrowDate);

            // Print times and weekdays to the console
            console.log('Sunrise Today:', sunriseToday);
            console.log('Sunset Today:', sunsetToday);
            console.log('Sunrise Tomorrow:', sunriseTmrw);
            console.log('Today\'s Weekday:', todayWeekday);

            // Update input fields
            document.getElementById('sunriseToday').value = sunriseToday;
            document.getElementById('sunsetToday').value = sunsetToday;
            document.getElementById('sunriseTmrw').value = sunriseTmrw;
            document.getElementById('weekday').value = todayWeekday;

            // Update the table
            updateTable();
        } else {
            console.error('Failed to get coordinates.');
        }
    } catch (error) {
        console.error('Error fetching data:', error);
    } finally {
        // Hide loading message
        document.getElementById('loadingMessage').style.display = 'none';
    }
}


// Helper functions for time conversion
function timeToSeconds(time) {
    let [hours, minutes, seconds] = time.replace(/(AM|PM)/, '').trim().split(':').map(Number); // Remove AM/PM and split by ':'
    
    if (time.includes('PM') && hours !== 12) {
        hours += 12; // Add 12 hours for PM times, except when it's 12 PM
    } else if (time.includes('AM') && hours === 12) {
        hours = 0; // Convert 12 AM to 0 hours (midnight)
    }

    return hours * 3600 + minutes * 60 + (seconds || 0);
}


// Example event listener to toggle format on button click
document.getElementById('toggleFormat').addEventListener('click', function() {
    const button = document.getElementById('toggleFormat');
    button.textContent = button.textContent === '12-hour' ?  '24-hour' : '12-hour' ;
});



// Function to convert seconds to time
function secondsToTime(seconds) {
    seconds = Math.round(seconds % 86400);
    let hrs = Math.floor(seconds / 3600);
    const mins = Math.floor((seconds % 3600) / 60);
    const secs = seconds % 60;

    // Get the current format from the button
    const formatButton = document.getElementById('toggleFormat');
    const is12HourFormat = formatButton.textContent === '12-hour';

    if (is12HourFormat) {
        // Convert to 12-hour format with AM/PM
        const period = hrs >= 12 ? 'PM' : 'AM';
        hrs = hrs % 12 || 12; // Handle 0 as 12 in 12-hour format
        return `${String(hrs).padStart(2, '0')}:${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')} ${period}`;
    } else {
        // 24-hour format
        return `${String(hrs).padStart(2, '0')}:${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
    }
}

async function takeScreenshot() {
    const element = document.getElementById('tableToCapture');
    const cityName = document.getElementById('cityName').value; // Replace with your city name
    console.log("cityName",cityName)
    const currentDate = document.getElementById('dateInput').value; // Date in locale format
    const currentTime = new Date().toLocaleTimeString(); // Time in locale format

    try {
        // Capture the screenshot
        const canvas = await html2canvas(element);
        const ctx = canvas.getContext('2d');

        // Define text properties
        const textHeight = 60; // Height for the text area at the bottom
        const margin = 10; // Margin from the edges
        const fontSize = 16;

        // Create a new canvas with extra height for the text
        const newCanvas = document.createElement('canvas');
        newCanvas.width = canvas.width;
        newCanvas.height = canvas.height + textHeight;
        const newCtx = newCanvas.getContext('2d');

        // Draw the original image onto the new canvas
        newCtx.drawImage(canvas, 0, 0);

        // Set text properties and background for readability
        newCtx.fillStyle = 'rgba(255, 255, 255, 0.8)'; // Semi-transparent white background
        newCtx.fillRect(0, canvas.height, canvas.width, textHeight); // Background rectangle

        // Set bold text properties
        newCtx.font = `bold ${fontSize}px Arial`;
        newCtx.fillStyle = 'black';
        newCtx.textAlign = 'left';

        // Add titles and values to the bottom of the canvas
        const titleHeight = fontSize * 1.5; // Adjust title height
        const titles = [`City: ${cityName}`, `Date: ${currentDate}`, `Time: ${currentTime}`];
        const xStart = margin;
        const yStart = canvas.height + fontSize + margin;

        titles.forEach((title, index) => {
            newCtx.fillText(title, xStart + index * (newCanvas.width / titles.length), yStart);
        });

        // Convert new canvas to image
        const img = newCanvas.toDataURL('image/png');

        if (navigator.canShare && navigator.canShare({ files: [new File([img], 'Panchangam.png', { type: 'image/png' })] })) {
            // Convert the data URL to a Blob
            const response = await fetch(img);
            const blob = await response.blob();

            // Create a File object from the Blob
            const file = new File([blob], 'Panchangam.png', { type: 'image/png' });

            // Use the Web Share API to share the file
            navigator.share({
                files: [file],
                title: 'Panchangam Screenshot',
                text: 'Here is the Panchangam screenshot you requested.',
            }).catch(error => {
                console.error('Error sharing:', error);
            });
        } else {
            // Fallback: download the image if sharing is not supported
            const link = document.createElement('a');
            link.href = img;
            link.download = 'Panchangam.png';
            link.click();
        }
    } catch (error) {
        console.error('Error taking screenshot:', error);
    }
}


function updateTable() {
    const sunriseToday = document.getElementById('sunriseToday').value;
    const sunsetToday = document.getElementById('sunsetToday').value;
    const sunriseTmrw = document.getElementById('sunriseTmrw').value;
    const weekday = document.getElementById('weekday').value;
    const total = "24:00:00";

    const sunriseTodaySec = timeToSeconds(sunriseToday);
    const sunsetTodaySec = timeToSeconds(sunsetToday);
    const sunriseTmrwSec = timeToSeconds(sunriseTmrw);
    const totalSec = timeToSeconds(total);

    const interval1 = (sunsetTodaySec - sunriseTodaySec) / 30;
    const interval2 = ((totalSec + sunriseTmrwSec) - sunsetTodaySec) / 30;
    const tableBody = document.getElementById('table-body');
    tableBody.innerHTML = ''; // Clear existing table rows
    
    let currentSec = sunriseTodaySec;
    const columnD = [];

    // Generate rows for 30 cells
    for (let i = 0; i < 30; i++) {
        const start = secondsToTime(currentSec);
        currentSec += interval1;
        const end = secondsToTime(currentSec);

        tableBody.innerHTML += `
            <tr>
                <td>${start}</td>
                <td>${end}</td>
                <td></td>
                <td></td>
                <td></td>
                <td>${i + 1}</td>
                <td></td>
                <td></td>
            </tr>
        `;
    }

 // Levenshtein distance function
function levenshtein(a, b) {
    let tmp;
    let i, j;
    const alen = a.length;
    const blen = b.length;
    const arr = [];
    
    if (alen === 0) { return blen; }
    if (blen === 0) { return alen; }

    for (i = 0; i <= blen; i++) { arr[i] = [i]; }
    for (j = 0; j <= alen; j++) { arr[0][j] = j; }

    for (i = 1; i <= blen; i++) {
        for (j = 1; j <= alen; j++) {
            tmp = a[j - 1] === b[i - 1] ? 0 : 1;
            arr[i][j] = Math.min(arr[i - 1][j] + 1, arr[i][j - 1] + 1, arr[i - 1][j - 1] + tmp);
        }
    }

    return arr[blen][alen];
}

// Possible correct day names
const dayNames = {
    "Monday": ["monday", "mon", "mondy", "moday"],
    "Tuesday": ["tuesday", "tues", "tuesd", "tueday"],
    "Wednesday": ["wednesday", "wed", "wednes", "wensday"],
    "Thursday": ["thursday", "thur", "thurs", "thurday"],
    "Friday": ["friday", "fri", "frid", "fryday"],
    "Saturday": ["saturday", "sat", "satur", "saterday"],
    "Sunday": ["sunday", "sun", "sund", "sundey"]
};

// Find the closest match for a given input
function findClosestDay(input) {
    let minDistance = Infinity;
    let closestDay = "";
    
    const normalizedInput = input.toLowerCase();
    
    for (const [day, variants] of Object.entries(dayNames)) {
        for (const variant of variants) {
            const distance = levenshtein(normalizedInput, variant.toLowerCase());
            if (distance < minDistance) {
                minDistance = distance;
                closestDay = day;
            }
        }
    }
    
    return closestDay;
}

const rows = tableBody.getElementsByTagName('tr');
let previousD = sunsetTodaySec;

for (let i = 0; i < rows.length; i++) {
    const cells = rows[i].getElementsByTagName('td');
    if (cells.length > 5) {
        // Column D values
        if (i === 0) {
            previousD = sunsetTodaySec; // Start value for D0
            cells[3].textContent = secondsToTime(previousD);
        } else {
            previousD += interval2;
            cells[3].textContent = secondsToTime(previousD);
        }


        // Update Column E with next Column D value
        if (i < rows.length ) {
            const nextD = timeToSeconds(cells[3].textContent);
            console.log("nextD",nextD);
            console.log("time direct : ",cells[3].textContent);
            cells[4].textContent = secondsToTime(nextD + interval2);
        }
        
        let wkd = document.getElementById("weekday-html");
        let closestDay = findClosestDay(weekday); // Find the closest day name

        // Apply blue background to specific rows in Column C based on closest day
        const weekdayRows = {
            "Monday": [0, 5, 12, 13, 21, 26, 29],
            "Tuesday": [2, 3, 7, 8, 9, 11, 12, 13, 14, 15, 18, 20, 21, 22,24],
            "Wednesday": [0, 1, 4, 5, 6, 7, 9, 19, 27, 29], //28-
            "Thursday": [2, 5, 8, 11,13, 14, 15, 16, 18, 19, 20, 23, 24, 27, 28],
            "Friday": [1, 4, 6, 8, 14, 16, 18, 19, 22, 23, 24, 25, 26, 28],
            "Saturday": [0, 8, 9, 11, 12, 17, 22, 23, 25],
            "Sunday": [2, 3, 4, 5, 10, 14, 16, 19, 21, 23,24,25, 28]
        };

        const dayRows = weekdayRows[closestDay] || [];
        if (dayRows.includes(i)) {  
            cells[2].style.backgroundColor = '#002060'; // Apply blue color
            cells[2].style.color = '#E5FFCC'
            wkd.innerHTML = closestDay;
        }
        

        const update = [0, 1, 2, 3, 4, 5];
        if (update.includes(i)) { 
            if (update[i] === 0) {
                cells[6].textContent = secondsToTime(interval1);
                cells[6].style.backgroundColor = '#B4C6E7';  
            }
            if (update[i] === 1) {
                cells[6].textContent = secondsToTime(interval2); 
                cells[6].style.backgroundColor = '#B4C6E7';  
            }
            if (update[i] === 2) {
                cells[6].textContent = total;
                cells[6].style.backgroundColor = '#B4C6E7';   
            }
            if (update[i] === 3) {
                cells[6].textContent = "sunriseToday";
                cells[7].textContent = sunriseToday;
                cells[6].style.backgroundColor = 'none'; 
                cells[7].style.backgroundColor = ''; 
            }
            if (update[i] === 4) {
                cells[6].textContent = "sunsetToday";
                cells[7].textContent = sunsetToday;  
                cells[6].style.backgroundColor = 'none'; 
                cells[7].style.backgroundColor = '';  
            }
            if (update[i] === 5) {
                cells[6].textContent = "sunriseTmrw";
                cells[7].textContent = sunriseTmrw;   
                cells[6].style.backgroundColor = 'none'; 
                cells[7].style.backgroundColor = ''; 
            }
        }
    }
}

const weekdayValues = {
    "Sunday": [
        "ప్రయాణకార్యసిద్ధి", "విద్యాజయం", "ఉద్యోగ కష్టం", "శత్రువృద్ధి", "చోరభయం", "దుఃఖము", "అభీష్టసిద్ధి", "సౌఖ్యం-లాభం", 
        "వివాహాదిశుభాని", "మిత్రవృద్ధి", "మృత్యుభయం", "ఆరోగ్యం", "శుభకార్యజయం", "ప్రయత్నఫలం", "విషభయం", "ఉద్యోగం", 
        "జ్వరప్రాప్తి", "రాజసన్మానం", "ప్రయాణలాభము", "వివాదము", "మిత్రత్వము", "జ్వరభయము", "ధనలాభము", "బంధనం", 
        "స్థానభ్రంశము", "విద్యాభంగము", "స్త్రీ భోగం", "ప్రయాణ జయం", "ప్రయాణ నాశము", "భూలాభము"
    ],
    "Monday": [
        "కార్యహాని", "రాజపూజ్యత", "వాహన ప్రాప్తి", "స్త్రీ సౌఖ్యము", "భూలాభము", "స్థానభ్రంశము", "గుప్తధనలాభము", "వ్యవహారజయం", 
        "ఉద్యోగము", "ప్రియభోజనం", "స్త్రీ లాభము", "రాజదర్శనం", "కార్యభంగం", "రోగపీడ", "కార్యసిద్ధి", "శత్రునాశము", 
        "గో లాభము", "కార్యజయము", "ఆరోగ్యం", "మిత్రత్వము", "సౌఖ్యము", "కార్యభంగము", "వివాహజయం", "కార్యప్రాప్తి", 
        "ధనలాభము", "విద్యాలాభము", "స్థిరకార్యనాశము", "ఉద్యోగజయం", "యాత్రా ప్రాప్తి", "రాజభయం"
    ],
    "Tuesday": [
        "ధనలాభం", "ప్రయాణజయం", "దుఃఖము", "భూతభయము", "వాహనప్రాప్తి", "పరోపకారము", "వస్త్ర ప్రాప్తి", "ప్రయాణ నష్టం", 
        "వివాదహాని", "శత్రుబాధ", "స్త్రీ లాభము", "కార్యనాశనము", "కష్టం", "జంతు భయం", "అగ్నిబాధ", "రోగపీడ", 
        "పుత్రలాభము", "కార్యజయము", "చిక్కులు", "రాజ సన్మానం", "నమ్ము అగుట", "కార్యనష్టము", "అపజయం", "శత్రుజయం", 
        "ఉద్యోగహాని", "జయప్రదము", "కార్యసిద్ధి", "కార్యలాభం", "సుఖసౌఖ్యం", "మిత్రత్వము"
    ],
    "Wednesday": [
        "దుర్వార్తలు", "మనఃక్షోభం", "ధనలాభం", "యత్నకార్యసిద్ధి", "కార్యభంగము", "మహాభయము", "మనశ్చాంచల్యం", "ఉపద్రవములు", 
        "జయప్రదము", "ప్రయాణభయము", "రాజసన్మానము", "ధనధాన్యవృద్ధి", "ఉద్యోగజయం", "లాభము", "ప్రయత్నజయం", "వస్త్ర లాభం", 
        "సంతోషం", "క్షేమం", "స్వల్పలాభం", "కలహము", "ఇష్టసిద్ధి", "పుత్రలాభము", "ఉద్యోగజయం", "ప్రయాణజయం", 
        "వ్యవహారజయం", "వివాహశుభం", "కార్యజయం", "మనఃక్లేశము", "బంధుసమాగము", "వాహనప్రమాదం"
    ],
    "Thursday": [
        "ధనలాభం", "మనోభీష్టసిద్ధి", "అనారోగ్యం", "వాహన ప్రాప్తి", "వివాహశుభం", "సుఖనాశనం", "ఉద్యోగజయం", "స్వామిదర్శనం", 
        "ప్రయాణభంగం", "కార్యసిద్ధి", "వ్యాపారజయం", "శత్రునాశం", "వివాహజయం", "రోగనాశం", "కలహప్రదం", "ఉద్యోగ నష్టం", "కోపతీవ్రత",
        "కార్యజయం", "స్థాననాశం", "చోరభయం", "వివాహకలహం", "వివాదజయం", "యాత్రాశుభం", "ధైర్యహాని", "కార్యభంగం", 
        "ప్రయాణక్షేమం", "వివాహ శుభం", "కలహప్రదం", "జ్వరశస్త్రబాధ", "విద్యాభివృద్ధి"
    ],
    "Friday": [
        "కార్యసిద్ధి", "కార్యనాశము", "ధనలాభము", "రాజానుగ్రహం", "అపజయం", "కార్యజయం", "దుఃఖం-భయం","ధైర్యం", "కష్టం-నష్టం", 
        "సౌఖ్యము", "అనుకూలము", "వస్తువాహనప్రాప్తి", "క్షేమం-లాభం", "కార్యవిజయం", "శస్త్ర భయం", "శత్రునాశం", "అతిభయము", 
        "విద్యాసిద్ధి","రోగ బాధలు", "దుఃఖము", "వాహనప్రాప్తి", "స్త్రీ లాభము", "స్పోటకపీడ", "విషజంతుభయం", "ప్రయాణకష్టం", "శత్రుభయం", 
        "కార్యనష్టం", "ప్రయాణసౌఖ్యం", "దుఃఖము", "రాజసన్మానం"  ],
    "Saturday": [
        "కార్యహాని", "సౌఖ్యము", "వివాహసిద్ధి", "మిత్రత్వం", "ప్రయాణజయం", "వాహనలాభం", "కార్యజయం", "రాజసన్మానం", 
        "కార్యనష్టం", "ప్రయాణహాని", "వస్త్ర-స్త్రీలాభాలు", "మనశ్చాంచల్యం", "మిత్రనష్టం", "మిత్రప్రాప్తి", "స్త్రీ లాభం", 
        "ధనలాభము", "ప్రయాణజయం", "ప్రయాణ నష్టం", "క్షేమం", "వాహనయోగం", "జ్ఞానవృద్ధి", "వినోదము", "కలహము", 
        "ఉద్యోగనష్టం", "ప్రయత్నజయం", "మనస్తాపం", "శత్రునాశం", "విరోధనాశనం", "ప్రయాణ లాభం","ప్రియవార్తలు"
    ]
};

for (let i = 0; i < rows.length; i++) {
    let wkd = document.getElementById("weekday-html");
    let closestDay = findClosestDay(weekday); // Find the closest day name
    const cells = rows[i].getElementsByTagName('td');
    if(weekday=="Wednesday" && i==28){
        cells[2].style.backgroundColor = 'yellow';
    }
    if (cells.length > 0) {
        const valuesForDay = weekdayValues[closestDay];
        if (i < valuesForDay.length) {
                    cells[2].textContent = valuesForDay[i];
                } else {
                    cells[2].textContent = '';
                    }    
        }
}  



    const lastA = secondsToTime(currentSec);
    const lastD = secondsToTime(previousD + interval2);

    const lastRow = document.createElement('tr');
    lastRow.innerHTML = `
        <td>${lastA}</td>
        <td></td>
        <td></td>
        <td>${lastD}</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    `;
    tableBody.appendChild(lastRow);
}

document.addEventListener("DOMContentLoaded", function() {
    updateTable();
});
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

</body>
</html>
